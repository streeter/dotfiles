#
# Global Git Configuration
#

[alias]
    # Pluralize
    branches = branch -a
    tags = tag
    stashes = stash list
    unmerged = diff --name-only --diff-filter=U
    remotes = remote -v


    ## checkout/fetch/merge/push/rebase

    # clone
    clone = clone --recursive

    # checkout
    co = checkout

    # Merge
    finish = !git checkout master && git merge --no-ff $1 && git push origin master && git branch -d $1

    # rebase
    purr = pull --rebase

    # diff
    d = diff
    ds = diff --staged
    dh = diff HEAD

    # log
    hist = log --decorate --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit --
    #hist = log --pretty=format:\"%h %ad | %s%d [%an]\" --graph --date=short
    oldest-ancestor = !zsh -c 'diff -u <(git rev-list --first-parent "${1:-master}") <(git rev-list --first-parent "${2:-HEAD}") | sed -ne \"s/^ //p\" | head -1' -

    # review
    review = "!sh -c 'SHA=${1:-HEAD}; BRANCH=${2:-develop}; if [ $SHA == $BRANCH ] ; then SHA=HEAD; fi; git diff $BRANCH...$SHA;' -"
    reviewtool = "!sh -c 'SHA=${1:-HEAD}; BRANCH=${2:-develop}; if [ $SHA == $BRANCH ] ; then SHA=HEAD; fi; git difftool -y -t Kaleidoscope $BRANCH...$SHA;' -"

    # show
    showtool = "!sh -c 'SHA=${1:-HEAD}; git difftool -y -t Kaleidoscope $SHA^..$SHA;' -"

    # status
    st = status -sb

    # stash
    stashdiff = stash show -u

    # others
    unstage = reset -q HEAD --
    uncommit = reset --mixed HEAD~
    undo = uncommit
    wdiff = diff --word-diff

    ignored = ls-files --others -i --exclude-standard

[apply]
    # Detect whitespace errors when applying a patch
    whitespace = fix

[branch]
    #autosetupmerge = trus

# Use `origin` as the default remote on the `master` branch in all cases
[branch "master"]
    remote = origin
    merge = refs/heads/master

[core]
    excludesfile = ~/.gitignore
    attributesfile = ~/.gitattributes
    # Treat certain kinds of whitespace as errors
    whitespace = fix,-indent-with-non-tab,cr-at-eol,space-before-tab,trailing-space
    pager = less -FXRS -x2
    trustctime = false

[color]
    diff = auto
    status = auto
    interactive = auto
    ui = auto
    pager = true

[color "branch"]
    current = yellow
    local = normal
    remote = red

[color "diff"]
    plain = normal
    #meta = yellow bold
    old = red
    new = green
    commit = yellow
    whitespace = normal red

[color "status"]
    header = normal
    updated = yellow
    changed = cyan
    untracked = red
    nobranch = red

[help]
    autocorrect = 1

[init]
    templatedir = "~/.gittemplate"

[push]
    default = current

# URL shorthands
[url "git@github.com:"]
    insteadOf = "gh:"
    insteadOf = "git://github.com/"
    #insteadOf = "https://github.com/"
    pushInsteadOf = "github:"
    pushInsteadOf = "git://github.com/"
[url "git://github.com/"]
    insteadOf = "github:"
[url "git@gist.github.com:"]
    insteadOf = "gst:"
    insteadOf = "https://gist.github.com/"
    pushInsteadOf = "gist:"
    pushInsteadOf = "git://gist.github.com/"
[url "git://gist.github.com/"]
    insteadOf = "gist:"

[user]
    name = Chris Streeter
    email = chris@chrisstreeter.com
    username = streeter
    useconfigonly = true
[heroku]
    account = personal
[diff]
    tool = Kaleidoscope
[difftool]
    prompt = false
[diff "spaceman-diff"]
    command = /usr/local/bin/spaceman-diff
[diff "plist"]
	textconv = plutil -convert xml1 -o -
[diff "localizablestrings"]
    textconv = "iconv -f utf-16 -t utf-8"
[difftool "Kaleidoscope"]
    cmd = ksdiff --partial-changeset --relative-path \"$MERGED\" -- \"$LOCAL\" \"$REMOTE\"
[mergetool "Kaleidoscope"]
    cmd = ksdiff --merge --output \"$MERGED\" --base \"$BASE\" -- \"$LOCAL\" --snapshot \"$REMOTE\" --snapshot
    trustExitCode = true
[mergetool]
    prompt = false
[merge]
    tool = Kaleidoscope
[credential]
    helper = osxkeychain
#[remote "origin"]
#    fetch = +refs/pull/*/head:refs/remotes/origin/pr/*
[stash]
	showPatch = true
[pager]
    diff = diff-so-fancy | less --tabs=1,5 -RFX --pattern='^(added|deleted|modified): '
    show = diff-so-fancy | less --tabs=1,5 -RFX --pattern='^(added|deleted|modified): '
[commit]
	gpgsign = true
