#!/bin/bash
#
# Notify of Homebrew updates via Notification Center on Mac OS X
#
# Author: Chris Streeter http://www.chrisstreeter.com
# Requires: terminal-notifier. Install with:
#   brew install terminal-notifier

PATH="/usr/local/bin:${PATH}"
TERM_APP='/Applications/Terminal.app'
BREW_EXEC=`which brew`
TERMINAL_NOTIFIER=`which terminal-notifier`
NOTIF_ARGS="-sender com.apple.Terminal -activate com.apple.Terminal -timeout 10"

$BREW_EXEC update 2>&1 > /dev/null
outdated=`$BREW_EXEC outdated | xargs echo -n`

title="No Homebrew Updates Available"
message="No updates available yet for any homebrew packages."

if [ ! -z "$outdated" ] ; then
    # We've got an outdated formula or two
    title="Homebrew Update(s) Available For"
    message="$outdated"
fi

# Notify via Notification Center
if [ -e $TERMINAL_NOTIFIER ]; then
    # Send to the Nofication Center
    $TERMINAL_NOTIFIER $NOTIF_ARGS \
        -title "$title" \
        -message "$message" 2>&1 > /dev/null
fi
