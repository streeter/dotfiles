#!/bin/bash
#
# Notify of Homebrew updates via Notification Center on Mac OS X
#
# Author: Chris Streeter http://www.chrisstreeter.com
# Requires: terminal-notifier. Install with:
#   brew install terminal-notifier

PATH="/usr/local/bin:${PATH}"
TERM_APP='/Applications/Terminal.app'
BREW_EXEC=`which brew`
TERMINAL_NOTIFIER=`which terminal-notifier`
NOTIF_ARGS="-sender com.apple.Terminal"

$BREW_EXEC update 2>&1 > /dev/null
outdated=`$BREW_EXEC outdated | xargs echo -n`

TITLE="No Homebrew Updates Available"
MESSAGE="No updates available yet for any homebrew packages."

if [ ! -z "$outdated" ] ; then
    # We've got an outdated formula or two
    NOTIF_ARGS="$NOTIF_ARGS -activate com.apple.Terminal -timeout 10"
    TITLE="Homebrew Update(s) Available For"
    MESSAGE="$outdated"
fi

# Notify via Notification Center
if [ -e $TERMINAL_NOTIFIER ]; then
    # Send to the Nofication Center
    $TERMINAL_NOTIFIER $NOTIF_ARGS \
        -title "$TITLE" \
        -message "$MESSAGE" 2>&1 > /dev/null
fi
